<h1>whatwg-url</h1><p>whatwg-url is a full implementation of the WHATWG <a href="https://url.spec.whatwg.org/">URL Standard</a>. It can be used standalone, but it also exposes a lot of the internal algorithms that are useful for integrating a URL parser into a project like <a href="https://github.com/tmpvar/jsdom">jsdom</a>.</p>
<h2>Current Status</h2><p>whatwg-url is currently up to date with the URL spec up to commit <a href="https://github.com/whatwg/url/commit/fe6b251739e225555f04319f19c70c031a5d99eb">fe6b25</a>.</p>
<h2>API</h2><h3>The <code>URL</code> Constructor</h3><p>The main API is the <a href="https://url.spec.whatwg.org/#url"><code>URL</code></a> export, which follows the spec&#39;s behavior in all ways (including e.g. <code>USVString</code> conversion). Most consumers of this library will want to use this.</p>
<h3>Low-level URL Standard API</h3><p>The following methods are exported for use by places like jsdom that need to implement things like <a href="https://html.spec.whatwg.org/#htmlhyperlinkelementutils"><code>HTMLHyperlinkElementUtils</code></a>. They operate on or return an &quot;internal URL&quot; or <a href="https://url.spec.whatwg.org/#concept-url">&quot;URL record&quot;</a> type.</p>
<ul>
<li><a href="https://url.spec.whatwg.org/#concept-url-parser">URL parser</a>: <code>parseURL(input, { baseURL, encodingOverride })</code></li>
<li><a href="https://url.spec.whatwg.org/#concept-basic-url-parser">Basic URL parser</a>: <code>basicURLParse(input, { baseURL, encodingOverride, url, stateOverride })</code></li>
<li><a href="https://url.spec.whatwg.org/#concept-url-serializer">URL serializer</a>: <code>serializeURL(urlRecord, excludeFragment)</code></li>
<li><a href="https://url.spec.whatwg.org/#concept-host-serializer">Host serializer</a>: <code>serializeHost(hostFromURLRecord)</code></li>
<li><a href="https://url.spec.whatwg.org/#serialize-an-integer">Serialize an integer</a>: <code>serializeInteger(number)</code></li>
<li><a href="https://url.spec.whatwg.org/#concept-url-origin">Origin</a> <a href="https://html.spec.whatwg.org/multipage/browsers.html#unicode-serialisation-of-an-origin">Unicode serializer</a>: <code>serializeURLToUnicodeOrigin(urlRecord)</code></li>
<li><a href="https://url.spec.whatwg.org/#set-the-username">Set the username</a>: <code>setTheUsername(urlRecord, usernameString)</code></li>
<li><a href="https://url.spec.whatwg.org/#set-the-password">Set the password</a>: <code>setThePassword(urlRecord, passwordString)</code></li>
<li><a href="https://url.spec.whatwg.org/#cannot-have-a-username-password-port">Cannot have a username/password/port</a>: <code>cannotHaveAUsernamePasswordPort(urlRecord)</code></li>
</ul>
<p>The <code>stateOverride</code> parameter is one of the following strings:</p>
<ul>
<li><a href="https://url.spec.whatwg.org/#scheme-start-state"><code>&quot;scheme start&quot;</code></a></li>
<li><a href="https://url.spec.whatwg.org/#scheme-state"><code>&quot;scheme&quot;</code></a></li>
<li><a href="https://url.spec.whatwg.org/#no-scheme-state"><code>&quot;no scheme&quot;</code></a></li>
<li><a href="https://url.spec.whatwg.org/#special-relative-or-authority-state"><code>&quot;special relative or authority&quot;</code></a></li>
<li><a href="https://url.spec.whatwg.org/#path-or-authority-state"><code>&quot;path or authority&quot;</code></a></li>
<li><a href="https://url.spec.whatwg.org/#relative-state"><code>&quot;relative&quot;</code></a></li>
<li><a href="https://url.spec.whatwg.org/#relative-slash-state"><code>&quot;relative slash&quot;</code></a></li>
<li><a href="https://url.spec.whatwg.org/#special-authority-slashes-state"><code>&quot;special authority slashes&quot;</code></a></li>
<li><a href="https://url.spec.whatwg.org/#special-authority-ignore-slashes-state"><code>&quot;special authority ignore slashes&quot;</code></a></li>
<li><a href="https://url.spec.whatwg.org/#authority-state"><code>&quot;authority&quot;</code></a></li>
<li><a href="https://url.spec.whatwg.org/#host-state"><code>&quot;host&quot;</code></a></li>
<li><a href="https://url.spec.whatwg.org/#hostname-state"><code>&quot;hostname&quot;</code></a></li>
<li><a href="https://url.spec.whatwg.org/#port-state"><code>&quot;port&quot;</code></a></li>
<li><a href="https://url.spec.whatwg.org/#file-state"><code>&quot;file&quot;</code></a></li>
<li><a href="https://url.spec.whatwg.org/#file-slash-state"><code>&quot;file slash&quot;</code></a></li>
<li><a href="https://url.spec.whatwg.org/#file-host-state"><code>&quot;file host&quot;</code></a></li>
<li><a href="https://url.spec.whatwg.org/#path-start-state"><code>&quot;path start&quot;</code></a></li>
<li><a href="https://url.spec.whatwg.org/#path-state"><code>&quot;path&quot;</code></a></li>
<li><a href="https://url.spec.whatwg.org/#cannot-be-a-base-url-path-state"><code>&quot;cannot-be-a-base-URL path&quot;</code></a></li>
<li><a href="https://url.spec.whatwg.org/#query-state"><code>&quot;query&quot;</code></a></li>
<li><a href="https://url.spec.whatwg.org/#fragment-state"><code>&quot;fragment&quot;</code></a></li>
</ul>
<p>The URL record type has the following API:</p>
<ul>
<li><a href="https://url.spec.whatwg.org/#concept-url-scheme"><code>scheme</code></a></li>
<li><a href="https://url.spec.whatwg.org/#concept-url-username"><code>username</code></a></li>
<li><a href="https://url.spec.whatwg.org/#concept-url-password"><code>password</code></a></li>
<li><a href="https://url.spec.whatwg.org/#concept-url-host"><code>host</code></a></li>
<li><a href="https://url.spec.whatwg.org/#concept-url-port"><code>port</code></a></li>
<li><a href="https://url.spec.whatwg.org/#concept-url-path"><code>path</code></a> (as an array)</li>
<li><a href="https://url.spec.whatwg.org/#concept-url-query"><code>query</code></a></li>
<li><a href="https://url.spec.whatwg.org/#concept-url-fragment"><code>fragment</code></a></li>
<li><a href="https://url.spec.whatwg.org/#url-cannot-be-a-base-url-flag"><code>cannotBeABaseURL</code></a> (as a boolean)</li>
</ul>
<p>These properties should be treated with care, as in general changing them will cause the URL record to be in an inconsistent state until the appropriate invocation of <code>basicURLParse</code> is used to fix it up. You can see examples of this in the URL Standard, where there are many step sequences like &quot;4. Set context object’s url’s fragment to the empty string. 5. Basic URL parse <em>input</em> with context object’s url as <em>url</em> and fragment state as <em>state override</em>.&quot; In between those two steps, a URL record is in an unusable state.</p>
<p>The return value of &quot;failure&quot; in the spec is represented by the string <code>&quot;failure&quot;</code>. That is, functions like <code>parseURL</code> and <code>basicURLParse</code> can return <em>either</em> a URL record <em>or</em> the string <code>&quot;failure&quot;</code>.</p>

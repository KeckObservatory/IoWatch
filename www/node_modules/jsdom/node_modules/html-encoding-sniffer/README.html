<h1>Determine the Encoding of a HTML Byte Stream</h1><p>This package implements the HTML Standard&#39;s <a href="https://html.spec.whatwg.org/multipage/syntax.html#encoding-sniffing-algorithm">encoding sniffing algorithm</a> in all its glory. The most interesting part of this is how it pre-scans the first 1024 bytes in order to search for certain <code>&lt;meta charset&gt;</code>-related patterns.</p>
<pre><code class="language-js">const htmlEncodingSniffer = require(&quot;html-encoding-sniffer&quot;);
const fs = require(&quot;fs&quot;);

const htmlBuffer = fs.readFileSync(&quot;./html-page.html&quot;);
const sniffedEncoding = htmlEncodingSniffer(htmlBuffer);
</code></pre>
<p>The returned value will be a canonical <a href="https://encoding.spec.whatwg.org/#names-and-labels">encoding name</a> (not a label). You might then combine this with the <a href="https://github.com/jsdom/whatwg-encoding">whatwg-encoding</a> package to decode the result:</p>
<pre><code class="language-js">const whatwgEncoding = require(&quot;whatwg-encoding&quot;);
const htmlString = whatwgEncoding.decode(htmlBuffer, sniffedEncoding);
</code></pre>
<h2>Options</h2><p>You can pass two potential options to <code>htmlEncodingSniffer</code>:</p>
<pre><code class="language-js">const sniffedEncoding = htmlEncodingSniffer(htmlBuffer, {
  transportLayerEncodingLabel,
  defaultEncoding
});
</code></pre>
<p>These represent two possible inputs into the <a href="https://html.spec.whatwg.org/multipage/syntax.html#encoding-sniffing-algorithm">encoding sniffing algorithm</a>:</p>
<ul>
<li><code>transportLayerEncodingLabel</code> is an encoding label that is obtained from the &quot;transport layer&quot; (probably a HTTP <code>Content-Type</code> header), which overrides everything but a BOM.</li>
<li><code>defaultEncoding</code> is the ultimate fallback encoding used if no valid encoding is supplied by the transport layer, and no encoding is sniffed from the bytes. It defaults to <code>&quot;windows-1252&quot;</code>, as recommended by the algorithm&#39;s table of suggested defaults for &quot;All other locales&quot; (including the <code>en</code> locale).</li>
</ul>
<h2>Credits</h2><p>This package was originally based on the excellent work of <a href="https://github.com/nicolashenry">@nicolashenry</a>, <a href="https://github.com/tmpvar/jsdom/blob/16fd85618f2705d181232f6552125872a37164bc/lib/jsdom/living/helpers/encoding.js">in jsdom</a>. It has since been pulled out into this separate package.</p>
